<!-- /***
 *    ██████╗  █████╗ ███████╗██╗ ██████╗
 *    ██╔══██╗██╔══██╗██╔════╝██║██╔════╝
 *    ██████╔╝███████║███████╗██║██║
 *    ██╔══██╗██╔══██║╚════██║██║██║
 *    ██████╔╝██║  ██║███████║██║╚██████╗
 *    ╚═════╝ ╚═╝  ╚═╝╚══════╝╚═╝ ╚═════╝
 *
 *     █████╗ ███╗   ██╗ ██████╗ ██╗   ██╗██╗      █████╗ ██████╗
 *    ██╔══██╗████╗  ██║██╔════╝ ██║   ██║██║     ██╔══██╗██╔══██╗
 *    ███████║██╔██╗ ██║██║  ███╗██║   ██║██║     ███████║██████╔╝
 *    ██╔══██║██║╚██╗██║██║   ██║██║   ██║██║     ██╔══██║██╔══██╗
 *    ██║  ██║██║ ╚████║╚██████╔╝╚██████╔╝███████╗██║  ██║██║  ██║
 *    ╚═╝  ╚═╝╚═╝  ╚═══╝ ╚═════╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝
 *
 *    ███████╗ ██████╗ ██████╗ ███╗   ███╗
 *    ██╔════╝██╔═══██╗██╔══██╗████╗ ████║
 *    █████╗  ██║   ██║██████╔╝██╔████╔██║
 *    ██╔══╝  ██║   ██║██╔══██╗██║╚██╔╝██║
 *    ██║     ╚██████╔╝██║  ██║██║ ╚═╝ ██║
 *    ╚═╝      ╚═════╝ ╚═╝  ╚═╝╚═╝     ╚═╝
 *
 *     ██████╗ ██████╗ ███╗   ███╗██████╗  ██████╗ ███╗   ██╗███████╗███╗   ██╗████████╗
 *    ██╔════╝██╔═══██╗████╗ ████║██╔══██╗██╔═══██╗████╗  ██║██╔════╝████╗  ██║╚══██╔══╝
 *    ██║     ██║   ██║██╔████╔██║██████╔╝██║   ██║██╔██╗ ██║█████╗  ██╔██╗ ██║   ██║
 *    ██║     ██║   ██║██║╚██╔╝██║██╔═══╝ ██║   ██║██║╚██╗██║██╔══╝  ██║╚██╗██║   ██║
 *    ╚██████╗╚██████╔╝██║ ╚═╝ ██║██║     ╚██████╔╝██║ ╚████║███████╗██║ ╚████║   ██║
 *     ╚═════╝ ╚═════╝ ╚═╝     ╚═╝╚═╝      ╚═════╝ ╚═╝  ╚═══╝╚══════╝╚═╝  ╚═══╝   ╚═╝
 *
 *    ████████╗███████╗███╗   ███╗██████╗ ██╗      █████╗ ████████╗███████╗
 *    ╚══██╔══╝██╔════╝████╗ ████║██╔══██╗██║     ██╔══██╗╚══██╔══╝██╔════╝
 *       ██║   █████╗  ██╔████╔██║██████╔╝██║     ███████║   ██║   █████╗
 *       ██║   ██╔══╝  ██║╚██╔╝██║██╔═══╝ ██║     ██╔══██║   ██║   ██╔══╝
 *       ██║   ███████╗██║ ╚═╝ ██║██║     ███████╗██║  ██║   ██║   ███████╗
 *       ╚═╝   ╚══════╝╚═╝     ╚═╝╚═╝     ╚══════╝╚═╝  ╚═╝   ╚═╝   ╚══════╝
 *
 */ -->
<form
    [formGroup]="userDetailsForm"
    (ngSubmit)="onSubmit()"
    fxLayout="row"
    fxLayoutAlign="center center">

  <div
    fxFlex="40rem"
    fxLayout="column"
    fxLayoutAlign="center start"
    fxLayoutGap="0.75rem">

    <!-- full name -->
    <div
        formGroupName="fullName"
        fxFill
        fxLayout="column"
        fxLayoutGap="0.75rem">

      <!-- first name -->
      <div
          fxFill
          fxLayout="row"
          fxLayoutGap="0.35rem">
        <label
            [ngClass]="{'error-input': !userDetailsForm.get('fullName.firstName').valid && userDetailsForm.get('fullName.firstName').touched}"
            fxFlex="30"
            fxLayout="row"
            fxLayoutAlign="end center"
            for="firstName">
          First name:
        </label>
        <div fxLayout="column">
          <input
              [ngClass]="{'error-input': !userDetailsForm.get('fullName.firstName').valid && userDetailsForm.get('fullName.firstName').touched}"
              formControlName="firstName"
              placeholder="Your first name..."
              id="firstName"
              type="text">
          <span
              class="error-message"
              *ngIf="!userDetailsForm.get('fullName.firstName').valid && userDetailsForm.get('fullName.firstName').touched">
            Please enter a valid first name!
          </span>
        </div>
      </div>

      <!-- last name -->
      <div
          fxFill
          fxLayout="row"
          fxLayoutGap="0.35rem">
        <label
            [ngClass]="{'error-input': !userDetailsForm.get('fullName.lastName').valid && userDetailsForm.get('fullName.lastName').touched}"
            fxFlex="30"
            fxLayout="row"
            fxLayoutAlign="end center"
            for="lastName">
          Last name:
        </label>
        <div fxLayout="column">
          <input
              [ngClass]="{'error-input': !userDetailsForm.get('fullName.lastName').valid && userDetailsForm.get('fullName.lastName').touched}"
              formControlName="lastName"
              placeholder="Your last name..."
              id="lastName"
              type="text">
          <span
              class="error-message"
              *ngIf="!userDetailsForm.get('fullName.lastName').valid && userDetailsForm.get('fullName.lastName').touched">
            Please enter a valid last name!
          </span>
        </div>
      </div>

    </div>

    <!-- username -->
    <div
        fxFill
        fxLayout="row"
        fxLayoutGap="0.35rem">
      <label
          [ngClass]="{
            'error-input': !userDetailsForm.get('username').valid &&
                          (!userDetailsForm.get('username').pristine || userDetailsForm.get('username').touched)
          }"
          fxFlex="30"
          fxLayout="row"
          fxLayoutAlign="end center"
          for="username">
        Username:
      </label>
      <div fxLayout="column">
        <input
            [ngClass]="{
              'error-input': !userDetailsForm.get('username').valid &&
                            (!userDetailsForm.get('username').pristine || userDetailsForm.get('username').touched)
            }"
            formControlName="username"
            placeholder="your username..."
            id="username"
            type="text">
        <span
            class="error-message"
            *ngIf="
              userDetailsForm.get('username').errors?.usernameForbiddenCharacter &&
              !userDetailsForm.get('username').pristine
            ">
          Only alphanumerics and underscores are permitted.<br>The first character must be a letter or an underscore.
        </span>
        <span
            class="error-message"
            *ngIf="!userDetailsForm.get('username').valid &&
                   (!userDetailsForm.get('username').pristine || userDetailsForm.get('username').touched)
            ">
          Please enter a valid username!
        </span>
      </div>
    </div>

    <!-- email -->
    <div
        fxFill
        fxLayout="row"
        fxLayoutGap="0.35rem">
      <label
          [ngClass]="{'error-input': !userDetailsForm.get('email').valid && userDetailsForm.get('email').touched}"
          fxFlex="30"
          fxLayout="row"
          fxLayoutAlign="end center"
          for="email">
        Email:
      </label>
      <div fxLayout="column">
        <input
            [ngClass]="{'error-input': !userDetailsForm.get('email').valid && userDetailsForm.get('email').touched}"
            formControlName="email"
            placeholder="your email..."
            id="email"
            type="email">
        <ng-container *ngIf="userDetailsForm.get('email').invalid && userDetailsForm.get('email').touched" >
          <ng-container [ngSwitch]="emailInputError()">
            <span class="error-message" *ngSwitchCase="'required'">
              Email is required!
            </span>
            <span class="error-message" *ngSwitchCase="'email'">
              Please enter a valid email!
            </span>
            <span class="error-message" *ngSwitchCase="'emailIsForbidden'">
              Using this email is forbidden!
            </span>
          </ng-container>
        </ng-container>
      </div>
    </div>

    <!-- birth date -->
    <div
        fxFill
        fxLayout="row"
        fxLayoutGap="0.35rem">
      <label
            [ngClass]="{'error-input': !userDetailsForm.get('birthDate').valid && userDetailsForm.get('birthDate').touched}"
            fxFlex="30"
            fxLayout="row"
            fxLayoutAlign="end center"
            for="birthDate">
          Birth date:
        </label>
      <div fxLayout="column">
        <input
            [ngClass]="{'error-input': !userDetailsForm.get('birthDate').valid && userDetailsForm.get('birthDate').touched}"
            formControlName="birthDate"
            placeholder="your birth date..."
            id="birthDate"
            type="date">
        <span
            class="error-message"
            *ngIf="!userDetailsForm.get('birthDate').valid && userDetailsForm.get('birthDate').touched">
          Please enter a valid date!
        </span>
      </div>
    </div>

    <!-- gender -->
    <div
        fxFill
        fxLayout="row"
        fxLayoutGap="0.35rem">
      <div
          fxFlex="30"
          fxLayout="row"
          fxLayoutAlign="end center">
        <label [ngClass]="{'error-input': !userDetailsForm.get('gender').valid && userDetailsForm.get('gender').touched}">
          Gender:
        </label>
      </div>
      <div fxLayout="column">
        <div
            fxLayout="row"
            fxLayoutGap="0.55rem">
          <div
              fxLayout="row"
              fxLayoutAlign="center center"
              fxLayoutGap="0.2rem">
            <input
                formControlName="gender"
                type="radio"
                id="genderMale"
                name="gender"
                value="male">
            <label
                [ngClass]="{'error-input': !userDetailsForm.get('gender').valid && userDetailsForm.get('gender').touched}"
                for="genderMale">
              Male
            </label>
          </div>
          <div
              fxLayout="row"
              fxLayoutAlign="center center"
              fxLayoutGap="0.2rem">
            <input
                formControlName="gender"
                type="radio"
                id="genderFemale"
                name="gender"
                value="female">
            <label
                [ngClass]="{'error-input': !userDetailsForm.get('gender').valid && userDetailsForm.get('gender').touched}"
                for="genderFemale">
              Female
            </label>
          </div>
        </div>
        <span
            class="error-message"
            *ngIf="!userDetailsForm.get('gender').valid && userDetailsForm.get('gender').touched">
          Please select your gender!
        </span>
      </div>
    </div>

    <!-- description -->
    <div
        fxFill
        fxLayout="row"
        fxLayoutGap="0.35rem">
      <label
          fxFlex="30"
          fxLayout="row"
          fxLayoutAlign="end center"
          for="description">
        Description:
      </label>
      <div fxLayout="column">
        <textarea
            formControlName="description"
            id="description"
            cols="30"
            rows="5"></textarea>
        <span
            class="hint-message"
            *ngIf="!userDetailsForm.get('description').pristine">
          You've entered {{userDetailsForm.get('description').value.length}} characters.
        </span>
      </div>
    </div>

    <!-- confirm hobbies -->
    <div
        fxFill
        fxLayout="row"
        fxLayoutGap="0.35rem">
      <div
          fxFlex="30"
          fxLayout="row"
          fxLayoutAlign="end center">
        &nbsp;
      </div>
      <div
          fxLayout="row"
          fxLayoutAlign="center center"
          fxLayoutGap="0.55rem">
        <input
            formControlName="confirmHobbies"
            id="confirmHobbies"
            type="checkbox">
        <label for="confirmHobbies">Check if user has some hobbies.</label>
      </div>
    </div>

    <!-- hobbies -->
    <ng-container
        formArrayName="hobbies"
        *ngIf="userDetailsForm.get('confirmHobbies').value">
      <div
          *ngFor="let hobbyInput of userDetailsForm.get('hobbies').controls; let index = index"
          fxFill
          fxLayout="row"
          fxLayoutGap="0.35rem">
        <label
            [ngClass]="{'error-input': !userDetailsForm.get('hobbies').controls[index].valid && userDetailsForm.get('hobbies').controls[index].touched}"
            fxFlex="30"
            fxLayout="row"
            fxLayoutAlign="end center"
            for="hobby{{ index + 1 }}">
          Hobby{{ index + 1 }}:
        </label>
        <div fxLayout="column">
          <div
              fxLayout="row"
              fxLayoutAlign="center center"
              fxLayoutGap="0.35rem">
            <input
                [ngClass]="{'error-input': !userDetailsForm.get('hobbies').controls[index].valid && userDetailsForm.get('hobbies').controls[index].touched}"
                formControlName="{{ index }}"
                placeholder="your hobby..."
                id="hobby{{index}}"
                type="text">
            <button
                *ngIf="index <= userDetailsForm.get('hobbies').length - 2"
                (click)="onDeleteHobbyInput(index)"
                class="deleteHobbyInput"
                type="button">
                -
            </button>
            <button
                [disabled]="!userDetailsForm.get('hobbies').controls[index].valid"
                *ngIf="index === userDetailsForm.get('hobbies').length - 1"
                (click)="onAddHobbyInput()"
                class="addHobbyInput"
                type="button">
              +
            </button>
          </div>
          <span
              class="error-message"
              *ngIf="!userDetailsForm.get('hobbies').controls[index].valid && userDetailsForm.get('hobbies').controls[index].touched">
            Please enter a hobby!
          </span>
        </div>
      </div>
    </ng-container>

    <!-- buttons -->
    <div
        fxFill
        fxLayout="row"
        fxLayoutGap="0.35rem">
      <div
          fxFlex="30"
          fxLayout="row"
          fxLayoutAlign="end center">
        &nbsp;
      </div>
      <div
          fxLayout="row"
          fxLayoutGap="0.55rem">
        <button
            *ngIf="userDetailsForm.valid"
            type="submit">
          Submit
        </button>
        <button
          *ngIf="userDetailsForm.invalid"
          (click)="validateAllFormFields(userDetailsForm)"
          type="button">
          Validate
        </button>
        <button type="reset">Reset</button>
      </div>
    </div>
  </div>
</form>

<div
    fxLayout="row"
    fxLayoutAlign="center center"
    *ngIf="submittedMessage">
  <span>Form submitted, open the console to see the result...</span>
</div>
